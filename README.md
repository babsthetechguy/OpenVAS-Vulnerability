# Vulnerability Management Lab - OpenVAS / Greenbone Edition!

# Introduction

In this Project, I deploy and set up OpenVAS/Greenbone to conduct both basic and credentialed vulnerability scans on Windows 10 Hosts, following the installation of insecure softwares. Throughout this project, I adhere to the six main stages of the Vulnerability Management Process—Discover, Prioritize, Assess, Report, Remediate, and Verify—ensuring a comprehensive approach to vulnerability mitigation. Consequently, the implementation enhances the security posture of the Virtual monitor by addressing a series of critical vulnerabilities, including those with high and medium severity levels that posed potential risks to global attackers.

# Preparation

I started by creating a free Azure account. This gives us the platform to perform all our activities.
Next, I moved on to setting up our Vulnerability Management Scanner by installing OpenVAS from the Azure marketplace. 



![Screenshot (300)](https://github.com/babsthetechguy/OpenVAS-Vulnerability/assets/150613649/56615d9f-ba19-4b4a-bcbd-999072fc67e8)



![Screenshot (303)](https://github.com/babsthetechguy/OpenVAS-Vulnerability/assets/150613649/0a601eea-aaac-44da-a384-f56057e4eae3)



I used a weak pre-set configuration for our virtual machine (VM) and SSH into it, After deployment of the OpenVAS, I log into the web app using the provided default credentials.


![Screenshot (305)](https://github.com/babsthetechguy/OpenVAS-Vulnerability/assets/150613649/72df6073-91ce-459b-8a02-b1659ffda7d4)



![Screenshot (307)](https://github.com/babsthetechguy/OpenVAS-Vulnerability/assets/150613649/c7269b2e-4f5e-46fe-9cb8-ae0788d9e115)



I then proceed to create a client virtual machine. This VM is intentionally made vulnerable for this exercises. It's important to set the VM in the same region and virtual network as OpenVAS for compatibility. 


![Screenshot (308)](https://github.com/babsthetechguy/OpenVAS-Vulnerability/assets/150613649/b4b2de20-66e7-4349-b50d-c53145f65071)

![Screenshot (309)](https://github.com/babsthetechguy/OpenVAS-Vulnerability/assets/150613649/a797d235-5ec9-489a-9b0e-ae06bdeb1f63)


Afterwards, I installed outdated versions of software like Firefox, VLC Player, and Adobe Reader to make it vulnerable.


![Screenshot (4) (1)](https://github.com/babsthetechguy/OpenVAS-Vulnerability/assets/150613649/7ea6334f-fd67-465f-8e4c-1f0a52946cd8)


![Screenshot (3)](https://github.com/babsthetechguy/OpenVAS-Vulnerability/assets/150613649/ef254ee6-fc08-4292-9d8f-c9a397b3c367)



## Rating After 1st Scan (Initial Settings)

Once the vulnerable VM is ready, I configure OpenVAS to perform my first unauthenticated scan against it. I create a new target, host, and task for this process. 

![Screenshot (313)](https://github.com/babsthetechguy/OpenVAS-Vulnerability/assets/150613649/eaaab6c6-c27a-41e0-b92b-3ba52b616dcd)

![Screenshot (314)](https://github.com/babsthetechguy/OpenVAS-Vulnerability/assets/150613649/726be40d-1a6f-47a5-90b0-431fdbd6bc15)

![Screenshot (317)](https://github.com/babsthetechguy/OpenVAS-Vulnerability/assets/150613649/36c0c986-2d52-415c-a38a-d67807f923fd)



After runing the scan, it generates this results which gives us insights into the VM's vulnerabilities.


![Screenshot (320)](https://github.com/babsthetechguy/OpenVAS-Vulnerability/assets/150613649/949750f0-559f-48b7-b176-60f26a7fb9fe)

![Screenshot (321)](https://github.com/babsthetechguy/OpenVAS-Vulnerability/assets/150613649/44ee6f92-9a44-4439-9ec4-6ed1031d9533)

![Screenshot (322)](https://github.com/babsthetechguy/OpenVAS-Vulnerability/assets/150613649/7e18c32b-7a4a-4c04-9aa7-edb106507fec)


## Preparing for 2nd Scan (Initial Settings)

Afterwards, we start preparations for credentialed scans. This involves making configurations within our VM like disabling the Windows Firewall and disabling the notifications in User Account Control Settings since the VM is not on the domain to get around for scanning.

![Screenshot (1)](https://github.com/babsthetechguy/OpenVAS-Vulnerability/assets/150613649/4cf144c3-4f5a-4b6a-bebe-f57b9cdb42ef)


![Screenshot (5)](https://github.com/babsthetechguy/OpenVAS-Vulnerability/assets/150613649/8a83d2de-5956-4ed5-a43e-8e508959aa57)



Then lastly, Enabling Remote Registry and adding a key to Registry Editor to further disable account control for the remote account for scans (making things easier for project) before restarting machine.


![Screenshot (324)](https://github.com/babsthetechguy/OpenVAS-Vulnerability/assets/150613649/6501888a-dd03-47be-9651-7f6843b363aa)


![Screenshot (326)](https://github.com/babsthetechguy/OpenVAS-Vulnerability/assets/150613649/c880a329-ab0b-4ac8-a314-596617da2fe5)



## Setting up 2nd Scan (Credentialed)

Similarly, configurations for credentialed scans are also made within OpenVAS. We create new credentials with our VM username and password, and also clone the previous target for this purpose.


![Screenshot (327)](https://github.com/babsthetechguy/OpenVAS-Vulnerability/assets/150613649/74aba388-9ca5-48cf-8678-f29812e05a27)


![Screenshot (329)](https://github.com/babsthetechguy/OpenVAS-Vulnerability/assets/150613649/83ac6cf7-f840-4757-bad0-254d05e13b3b)


![Screenshot (331)](https://github.com/babsthetechguy/OpenVAS-Vulnerability/assets/150613649/d6dcdbd0-dd22-443f-8462-9a6dc49cad18)


## Ratings after 2nd Scan (Credentialed) 

We execute the credentialed scan against our vulnerable VM using the newly created credentials. This scan takes longer than the previous one, but provides a more in-depth analysis of vulnerabilities.


![Screenshot (332)](https://github.com/babsthetechguy/OpenVAS-Vulnerability/assets/150613649/19f070f8-b0b1-4b8a-8560-247b6d1f918c)


![Screenshot (333)](https://github.com/babsthetechguy/OpenVAS-Vulnerability/assets/150613649/c80c130a-1ef9-4ecd-809f-8e817e15f979)


This shows the importance of running credentialed scans and the ability to discover even more vulnerabilities that I otherwise wouldn’t have been able to find in scans.
Once we've identified the vulnerabilities, we remediate them by uninstalling the outdated software and restarting the VM.


## 3rd Scan (Credentialed)

Finally, we verify our remediations by re-initiating the credentialed scan and observing the results.

![Screenshot (337)](https://github.com/babsthetechguy/OpenVAS-Vulnerability/assets/150613649/a875ed8f-f207-4595-b46b-90e63e92bfee)


![Screenshot (338)](https://github.com/babsthetechguy/OpenVAS-Vulnerability/assets/150613649/ee9eae6c-50d4-40f0-8923-7783b6310a77)



## Conclusion

In this project, several scans were created using OpenVAS / Greenbone to test unique environments that showed the vulnerabilities within each. Utilizing the tools available within our Azure vms, we were able to remediate many of the vulnerabilities present in our Windows 10 environment and get hands on practice with using the OpenVAS / Greenbone in a live environment. This entire process gives us valuable experience in vulnerability management, from creation to remediation. Remember, this lab is intended for educational purposes and it's crucial to always follow ethical practices in cybersecurity. 
